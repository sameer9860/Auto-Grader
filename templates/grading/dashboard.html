{% extends 'base.html' %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="mb-8">
    <h1 class="text-3xl font-bold text-gray-800">Dashboard</h1>
    <p class="text-gray-600">Overview of student performance and recent activities</p>
</div>

<!-- Summary Cards -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
    <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-primary">
        <div class="flex justify-between items-start">
            <div>
                <p class="text-sm font-medium text-gray-500">Total Students</p>
                <h3 class="text-2xl font-bold text-gray-800">{{ total_students }}</h3>
            </div>
            <div class="p-3 bg-blue-100 rounded-full text-primary">
                <i class="fas fa-users"></i>
            </div>
        </div>
    </div>

    <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-indigo-500">
        <div class="flex justify-between items-start">
            <div>
                <p class="text-sm font-medium text-gray-500">Total Exams</p>
                <h3 class="text-2xl font-bold text-gray-800">{{ total_exams }}</h3>
            </div>
            <div class="p-3 bg-indigo-100 rounded-full text-indigo-500">
                <i class="fas fa-file-alt"></i>
            </div>
        </div>
    </div>

    <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-success">
        <div class="flex justify-between items-start">
            <div>
                <p class="text-sm font-medium text-gray-500">Total Results</p>
                <h3 class="text-2xl font-bold text-gray-800">{{ total_results }}</h3>
            </div>
            <div class="p-3 bg-green-100 rounded-full text-success">
                <i class="fas fa-clipboard-check"></i>
            </div>
        </div>
    </div>

    <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-secondary">
        <div class="flex justify-between items-start">
            <div>
                <p class="text-sm font-medium text-gray-500">Avg Performance</p>
                <h3 class="text-2xl font-bold text-gray-800">B+</h3>
            </div>
            <div class="p-3 bg-red-100 rounded-full text-secondary">
                <i class="fas fa-chart-line"></i>
            </div>
        </div>
        <p class="text-xs text-gray-500 mt-2">Based on recent exams</p>
    </div>
</div>

<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    <!-- Grade Distribution -->
    <div class="bg-white p-6 rounded-lg shadow-sm lg:col-span-2">
        <h3 class="text-lg font-bold text-gray-800 mb-4">Grade Distribution</h3>
        {% if grade_stats %}
        <div class="h-64 flex items-end space-x-4 border-b border-gray-200 pb-4">
            {% for stat in grade_stats %}
            <div class="flex-1 flex flex-col items-center group">
                <div class="relative w-full flex justify-end flex-col items-center">
                    <span class="mb-1 text-xs opacity-0 group-hover:opacity-100 transition">{{ stat.count }}</span>
                    <div class="w-full bg-primary bg-opacity-80 rounded-t-sm hover:bg-opacity-100 transition"
                        style="height: {% widthratio stat.count total_results 200 %}px; min-height: 4px;"></div>
                </div>
                <span class="mt-2 text-sm font-medium">{{ stat.grade }}</span>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="h-64 flex items-center justify-center text-gray-400 bg-gray-50 rounded">
            <p>No grading data available</p>
        </div>
        {% endif %}
    </div>

    <!-- Quick Actions -->
    <div class="space-y-6">
        <div class="bg-white p-6 rounded-lg shadow-sm">
            <h3 class="text-lg font-bold text-gray-800 mb-4">Quick Actions</h3>
            <div class="space-y-3">
                <a href="{% url 'students:student_add' %}"
                    class="block w-full text-left px-4 py-3 bg-gray-50 hover:bg-blue-50 hover:text-primary rounded-md transition flex items-center">
                    <i class="fas fa-user-plus w-6"></i> Add Student
                </a>
                <a href="{% url 'exams:exam_add' %}"
                    class="block w-full text-left px-4 py-3 bg-gray-50 hover:bg-blue-50 hover:text-primary rounded-md transition flex items-center">
                    <i class="fas fa-file-signature w-6"></i> Create Exam
                </a>
                <a href="#!"
                    class="block w-full text-left px-4 py-3 bg-gray-50 hover:bg-blue-50 hover:text-primary rounded-md transition flex items-center">
                    <i class="fas fa-upload w-6"></i> Bulk Mark Entry
                </a>
            </div>
        </div>

        <!-- Recent Results -->
        <div class="bg-white p-6 rounded-lg shadow-sm">
            <h3 class="text-lg font-bold text-gray-800 mb-4">Recent Results</h3>
            <div class="space-y-4">
                {% for result in recent_results %}
                <div class="flex justify-between items-center pb-3 border-b border-gray-100 last:border-0">
                    <div>
                        <h4 class="font-medium text-gray-800">{{ result.student.name }}</h4>
                        <p class="text-xs text-gray-500">{{ result.subject.name }}</p>
                    </div>
                    <span class="px-2 py-1 text-xs font-bold rounded 
                        {% if result.grade == 'A+' or result.grade == 'A' %}bg-green-100 text-green-700
                        {% elif result.grade == 'NG' %}bg-red-100 text-red-700
                        {% else %}bg-blue-100 text-blue-700{% endif %}">
                        {{ result.grade }}
                    </span>
                </div>
                {% empty %}
                <p class="text-gray-400 text-sm text-center">No recent results</p>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}